# SMART IoT Flower pot
Open-source Интернет-вещей проект умного цветочного горшка с WiFI и управлением через ThingWorx academic


- Система автополива
- Датчики влажности, освещенности, температуры, влажности почвы
- Автоматическое дополнительное освещение по типу "Розовой фермы"
- WiFI

# Contents
- SMART IoT Flower pot
  - [Галерея](#Галерея)
  - [Описание](#Описание)
  - [Схема](#Схема)
   - [Подключение](#Подключение)
   - [Необходимые библиотеки](#Библиотеки)
  - [Заключение](#Заключение)

------------


## Галерея
### Настройка цвета подсветки. Для каждого растения свой цвет
![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/Preview-1.jpg)

![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/Preview-2.jpg)

### Мэшап в ThingWorx academic
![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/Meshup.png)

### Мозги!
![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/Hardware.jpg)


------------


## Описание
- Основными мозгами является Arduino® Mega. Конечно, можно использовать и любую другую платформу, но у меня в наличие оказались только Mega и Nano.
- Для связи с Thingworx® Academic я взял WiFi-модуль ESP8266, в который зашил скетч связи с сервером и общения по UART с основной Arduino® Mega. Можно вообще обойтись лишь одной ESP8266, но данный проект рассчитан на новичков, и для большей наглядности и простоты управления было выбрано подобное разделение.
- Умный горшок умеет поливать растение, следить за нехваткой света, и в случае его нехватки, включать адаптивную подсветку, яркость которой зависит от окружающей среды. 
- Подсветка не является статичной. Светодиоды "сменяют друг друга". Так же, через мэшап можно настроить цвет подсветки. Например, для красных листьев, нужен зеленый свет, а для зеленых, розовый. Т.к. листья способны поглощать лишь определенную часть спектра. В идеале, цвет необходимо настроить так, чтобы листья в его свете казались как можно темнее.
- Так же, горшок измеряет уровень влажности и температуру около растения, отправляя все свединия на сервер.


------------


## Схема

![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/MainScheme.jpg)

### Подключение
                    
| Arduino  | Датчик  | Описание |
| :------------ |:---------------:| -----:|
| +5V      | USB Micro VCC | Силовое питание +5V 2A |
| GND     | USB Micro GND |   Земля" основного питания |
| TX3 | ESP8266 RX        |    WiFi |
| RX3 | ESP8266 TX        |    WiFi |
| A0 | Аналоговый выход датчика влажности почвы   |  Moisture   |
| A2 | GND датчика влажности почвы   |  Moisture    |
| A3 | VCC датчика влажности почвы   |  Moisture   |
| A8 | GND датчика освещенности   |   Light  |
| A9 | VCC датчика освещенности   |  Light   |
| A10 | Выход датчика освещенности   |   Light  |
| 9 |  Пин DIN ленты   | Через резистор на 220 Ом   |
| 5 |  Затвор N-мосфета помпы   | Через резистор на 220 Ом   |
| SCL |  SHT31 SCL   | Temp/Humid   |
| SDA |  SHT31 SDA  | Temp/Humid   |
                    



------------

## Настройка, подключение, прошивка

### Библиотеки
В начале необходимо установить следующие библиотеки:
ESP8266WiFi.h
Wire.h
Adafruit_SHT31.h
Adafruit_NeoPixel.h
ArduinoJson.h

### ESP8266
Далее нам необходимо прошить наш WiFi модуль. В этом проекте отлично подходит и Ethernet Shield, адаптировать код несоставит труда.
Подключаем ESP8266 к UART-программатору, переводим его в режим Program, перезагружаем. Прошивать лучше всего прямо из Arduino® IDE, предварительно установив платы и выбрав "Generic ESP8266". На эту тему очень много гайдов.
В скетче необходимо вписать данные точки доступа, а также настройки вашего ThingWorx. После загрузки, переводим Wifi модуль в режим UART, и собираем остальную часть схемы

### Arduino®
В основном скетче также необходимо выбрать некоторые настройки для себя. Скетч загружается обычным образом, через Arduino® IDE. После всей сборки, прошивки и подключения, всё должно заработаь с 1 раза

### Thingworx®
На данном этапе вам необходимо создать Meshup, Сервис Ввоода-вывода, Переменные и т.п. это очень обширная тема, на которую также сущетсвует немало гайдов. Вот примеры моего мэшапа, сервисов, и переменных

#### Мэшап
![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/Meshup.png)

#### InputOutput Service
![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/InputOutputService.png)

#### Properties
![](https://raw.github.com/XxOinvizioNxX/SMART_flowerpot/master/Images/Properties.png)
------------
## Заключение
Такой умный горшок является отличной практикой при разработке IoT для начинающих. В собранном виде может помочь выживать растениям при длительном отсутсвии хозяев. При наличии большого резервуара с водой, система достаточно автономна.

------------

